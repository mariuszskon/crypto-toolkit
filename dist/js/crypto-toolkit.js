function gid(t){return document.getElementById(t)}function highlightChosen(t){for(var e=0;e<mainToolbarButtons.length;e++)mainToolbarButtons[e].style.backgroundColor="#FF6600";t.style.backgroundColor="#FF9900"}function manageToolbarButtons(t){highlightChosen(t.target);for(var e=0;e<subMenus.length;e++)subMenus[e].style.display="none";gid(t.target.id.replace(/button/,"menu")).style.display="block"}function openPage(){var t=window.location.hash.slice(1);if(""!==t){var e=gid(window.location.hash.slice(1));if(null!==e){for(var r=gid("main").getElementsByTagName("div"),n=0;n<r.length;n++)r[n].style.display="none";e.style.display="block"}}}function manageSubLinks(t){window.location=t.target.href,openPage()}function caesarGetDOMValues(){return{input:gid("caesar-input").value,key:parseInt(gid("caesar-key").value)}}function caesarDOMmanage(t){var e=caesarGetDOMValues(),r=cipher.caesar(t,e.input,e.key);null===r&&(r="Key is invalid (must be between 1 and "+(data.alphabet.length-1)+")"),gid("caesar-output").innerHTML=r}function vigenereGetDOMValues(){return{input:gid("vigenere-input").value,key:gid("vigenere-key").value}}function vigenereDOMmanage(t){var e=vigenereGetDOMValues();gid("vigenere-output").innerHTML=cipher.vigenere(t,e.input,e.key)}function rsatogglemenu(t){var e=gid(t.target.id.replace(/-button/,""));"block"===e.style.display?e.style.display="none":e.style.display="block"}function rsadomcrypt(t){var e=gid("rsa-crypt-message").value;if("rsa-encrypt"===t.target.id){var r=JSON.parse(gid("rsa-crypt-pub").value);gid("rsa-crypt-result").innerHTML=modern.rsaCrypt(e,r.e,r.n)}if("rsa-decrypt"===t.target.id){var n=JSON.parse(gid("rsa-crypt-priv").value);gid("rsa-crypt-result").innerHTML=modern.rsaCrypt(e,n.d,n.n)}}var data={},internal={},cipher={},modern={},cracker={};data.alphabet=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],data.upperbet=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],data.lowandup=data.alphabet.concat(data.upperbet),data.alphanumeric=data.lowandup.concat(["0","1","2","3","4","5","6","7","8","9"]),cipher.caesar=function(t,e,r){var n="",i=e.replace(/\s/g,"");if(1>r||r>data.alphabet.length-1)return null;for(var o=0;o<i.length;o++){var a,s=data.alphabet.indexOf(i.charAt(o));t===!0&&(a=s+r,a%=data.alphabet.length),t===!1&&(a=s-r,0>a&&(a+=data.alphabet.length)),n+=data.alphabet[a]}return n},cipher.vigenereGetKeyLetterAlphabetPosition=function(t,e){var r=t%e.length,n=e.charAt(r);return data.alphabet.indexOf(n)},cipher.vigenere=function(t,e,r){for(var n="",i=e.replace(/\s/g,""),o=0;o<i.length;o++)if("\n"!=i.charAt(o)){var a=data.alphabet.indexOf(i.charAt(o)),s="";if(t===!0)s=(a+cipher.vigenereGetKeyLetterAlphabetPosition(o,r))%data.alphabet.length;else if(t===!1){var u=a-cipher.vigenereGetKeyLetterAlphabetPosition(o,r);s=0>u?u+data.alphabet.length:u}n+=data.alphabet[s]}return n};var bigInt=function(t){"use strict";function e(t,e){this.value=t,this.sign=e,this.isSmall=!1}function r(t){this.value=t,this.sign=0>t,this.isSmall=!0}function n(t){return t>-J&&J>t}function i(t){return 1e7>t?[t]:1e14>t?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function o(t){a(t);var e=t.length;if(4>e&&S(t,K)<0)switch(e){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*j;default:return t[0]+(t[1]+t[2]*j)*j}return t}function a(t){for(var e=t.length;0===t[--e];);t.length=e+1}function s(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function u(t){return t>0?Math.floor(t):Math.ceil(t)}function p(t,e){var r,n,i=t.length,o=e.length,a=new Array(i),s=0,u=j;for(n=0;o>n;n++)r=t[n]+e[n]+s,s=r>=u?1:0,a[n]=r-s*u;for(;i>n;)r=t[n]+s,s=r===u?1:0,a[n++]=r-s*u;return s>0&&a.push(s),a}function l(t,e){return t.length>=e.length?p(t,e):p(e,t)}function h(t,e){var r,n,i=t.length,o=new Array(i),a=j;for(n=0;i>n;n++)r=t[n]-a+e,e=Math.floor(r/a),o[n]=r-e*a,e+=1;for(;e>0;)o[n++]=e%a,e=Math.floor(e/a);return o}function f(t,e){var r,n,i=t.length,o=e.length,s=new Array(i),u=0,p=j;for(r=0;o>r;r++)n=t[r]-u-e[r],0>n?(n+=p,u=1):u=0,s[r]=n;for(r=o;i>r;r++){if(n=t[r]-u,!(0>n)){s[r++]=n;break}n+=p,s[r]=n}for(;i>r;r++)s[r]=t[r];return a(s),s}function v(t,n,i){var a;return S(t,n)>=0?a=f(t,n):(a=f(n,t),i=!i),a=o(a),"number"==typeof a?(i&&(a=-a),new r(a)):new e(a,i)}function g(t,n,i){var a,s,u=t.length,p=new Array(u),l=-n,h=j;for(a=0;u>a;a++)s=t[a]+l,l=Math.floor(s/h),p[a]=0>s?s%h+h:s;return p=o(p),"number"==typeof p?(i&&(p=-p),new r(p)):new e(p,i)}function c(t,e){var r,n,i,o,u,p=t.length,l=e.length,h=p+l,f=s(h),v=j;for(i=0;p>i;++i){o=t[i];for(var g=0;l>g;++g)u=e[g],r=o*u+f[i+g],n=Math.floor(r/v),f[i+g]=r-n*v,f[i+g+1]+=n}return a(f),f}function d(t,e){var r,n,i=t.length,o=new Array(i),a=j,s=0;for(n=0;i>n;n++)r=t[n]*e+s,s=Math.floor(r/a),o[n]=r-s*a;for(;s>0;)o[n++]=s%a,s=Math.floor(s/a);return o}function y(t,e){for(var r=[];e-->0;)r.push(0);return r.concat(t)}function m(t,e){var r=Math.max(t.length,e.length);if(400>=r)return c(t,e);r=Math.ceil(r/2);var n=t.slice(r),i=t.slice(0,r),o=e.slice(r),a=e.slice(0,r),s=m(i,a),u=m(n,o),p=m(l(i,n),l(a,o));return l(l(s,y(f(f(p,s),u),r)),y(u,2*r))}function b(t,r,n){return j>t?new e(d(r,t),n):new e(c(r,i(t)),n)}function w(t){var e,r,n,i,o,u=t.length,p=s(u+u),l=j;for(n=0;u>n;n++){i=t[n];for(var h=0;u>h;h++)o=t[h],e=i*o+p[n+h],r=Math.floor(e/l),p[n+h]=e-r*l,p[n+h+1]+=r}return a(p),p}function M(t,e){var r,n,i,a,u,p,l,h=t.length,f=e.length,v=j,g=s(e.length),c=e[f-1],y=Math.ceil(v/(2*c)),m=d(t,y),b=d(e,y);for(m.length<=h&&m.push(0),b.push(0),c=b[f-1],n=h-f;n>=0;n--){for(r=v-1,r=Math.floor((m[n+f]*v+m[n+f-1])/c),i=0,a=0,p=b.length,u=0;p>u;u++)i+=r*b[u],l=Math.floor(i/v),a+=m[n+u]-(i-l*v),i=l,0>a?(m[n+u]=a+v,a=-1):(m[n+u]=a,a=0);for(;0!==a;){for(r-=1,i=0,u=0;p>u;u++)i+=m[n+u]-v+b[u],0>i?(m[n+u]=i+v,i=0):(m[n+u]=i,i=1);a+=i}g[n]=r}return m=q(m,y)[0],[o(g),o(m)]}function E(t,e){for(var r,n,i,a,s,u=t.length,p=e.length,l=[],h=[],v=j;u;)if(h.unshift(t[--u]),S(h,e)<0)l.push(0);else{n=h.length,i=h[n-1]*v+h[n-2],a=e[p-1]*v+e[p-2],n>p&&(i=(i+1)*v),r=Math.ceil(i/a);do{if(s=d(e,r),S(s,h)<=0)break;r--}while(r);l.push(r),h=f(h,s)}return l.reverse(),[o(l),o(h)]}function q(t,e){var r,n,i,o,a=t.length,p=s(a),l=j;for(i=0,r=a-1;r>=0;--r)o=i*l+t[r],n=u(o/e),i=o-n*e,p[r]=0|n;return[p,0|i]}function k(t,n){var a,s,p=G(n),l=t.value,h=p.value;if(0===h)throw new Error("Cannot divide by zero");if(t.isSmall)return p.isSmall?[new r(u(l/h)),new r(l%h)]:[_[0],t];if(p.isSmall){if(1===h)return[t,_[0]];if(-1==h)return[t.negate(),_[0]];var f=Math.abs(h);if(j>f){a=q(l,f),s=o(a[0]);var v=a[1];return t.sign&&(v=-v),"number"==typeof s?(t.sign!==p.sign&&(s=-s),[new r(s),new r(v)]):[new e(s,t.sign!==p.sign),new r(v)]}h=i(f)}var g=S(l,h);if(-1===g)return[_[0],t];if(0===g)return[_[t.sign===p.sign?1:-1],_[0]];a=l.length+h.length<=200?M(l,h):E(l,h),s=a[0];var c=t.sign!==p.sign,d=a[1],y=t.sign;return"number"==typeof s?(c&&(s=-s),s=new r(s)):s=new e(s,c),"number"==typeof d?(y&&(d=-d),d=new r(d)):d=new e(d,y),[s,d]}function S(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function P(t){var e=t.abs();return e.isUnit()?!1:e.equals(2)||e.equals(3)||e.equals(5)?!0:e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5)?!1:e.lesser(25)?!0:void 0}function O(t){return("number"==typeof t||"string"==typeof t)&&+Math.abs(t)<=j||t instanceof e&&t.value.length<=1}function L(t,e,r){e=G(e);for(var n=t.isNegative(),i=e.isNegative(),o=n?t.not():t,a=i?e.not():e,s=[],u=[],p=!1,l=!1;!p||!l;)o.isZero()?(p=!0,s.push(n?1:0)):n?s.push(o.isEven()?1:0):s.push(o.isEven()?0:1),a.isZero()?(l=!0,u.push(i?1:0)):i?u.push(a.isEven()?1:0):u.push(a.isEven()?0:1),o=o.over(2),a=a.over(2);for(var h=[],f=0;f<s.length;f++)h.push(r(s[f],u[f]));for(var v=bigInt(h.pop()).negate().times(bigInt(2).pow(h.length));h.length;)v=v.add(bigInt(h.pop()).times(bigInt(2).pow(h.length)));return v}function I(t,e){return t=G(t),e=G(e),t.greater(e)?t:e}function A(t,e){return t=G(t),e=G(e),t.lesser(e)?t:e}function N(t,e){return t=G(t).abs(),e=G(e).abs(),t.equals(e)?t:t.isZero()?e:e.isZero()?t:t.isEven()?e.isOdd()?N(t.divide(2),e):N(t.divide(2),e.divide(2)).multiply(2):e.isEven()?N(t,e.divide(2)):t.greater(e)?N(t.subtract(e).divide(2),e):N(e.subtract(t).divide(2),t)}function x(t,e){return t=G(t).abs(),e=G(e).abs(),t.multiply(e).divide(N(t,e))}function B(t,r){t=G(t),r=G(r);var n=A(t,r),i=I(t,r),a=i.subtract(n);if(a.isSmall)return n.add(Math.round(Math.random()*a));for(var s=a.value.length-1,p=[],l=!0,h=s;h>=0;h--){var f=l?a.value[h]:j,v=u(Math.random()*f);p.unshift(v),f>v&&(l=!1)}return p=o(p),n.add(new e(p,!1,"number"==typeof p))}function T(t){var e=t.value;return"number"==typeof e&&(e=[e]),1===e.length&&e[0]<=36?"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e[0]):"<"+e+">"}function D(t,e){if(e=bigInt(e),e.isZero()){if(t.isZero())return"0";throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1))return t.isZero()?"0":t.isNegative()?new Array(1-t).join("10"):"1"+new Array(+t).join("01");var r="";if(t.isNegative()&&e.isPositive()&&(r="-",t=t.abs()),e.equals(1))return t.isZero()?"0":r+new Array(+t+1).join(1);for(var n,i=[],o=t;o.isNegative()||o.compareAbs(e)>=0;){n=o.divmod(e),o=n.quotient;var a=n.remainder;a.isNegative()&&(a=e.minus(a).abs(),o=o.next()),i.push(T(a))}return i.push(T(o)),r+i.reverse().join("")}function C(t){if(n(+t)){var i=+t;if(i===u(i))return new r(i);throw"Invalid integer: "+t}var o="-"===t[0];o&&(t=t.slice(1));var s=t.split(/e/i);if(s.length>2)throw new Error("Invalid integer: "+l.join("e"));if(2===s.length){var p=s[1];if("+"===p[0]&&(p=p.slice(1)),p=+p,p!==u(p)||!n(p))throw new Error("Invalid integer: "+p+" is not a valid exponent.");var l=s[0],h=l.indexOf(".");if(h>=0&&(p-=l.length-h,l=l.slice(0,h)+l.slice(h+1)),0>p)throw new Error("Cannot include negative exponent part for integers");l+=new Array(p+1).join("0"),t=l}var f=/^([0-9][0-9]*)$/.test(t);if(!f)throw new Error("Invalid integer: "+t);for(var v=[],g=t.length,c=H,d=g-c;g>0;)v.push(+t.slice(d,g)),d-=c,0>d&&(d=0),g-=c;return a(v),new e(v,o)}function Z(t){return n(t)?new r(t):C(t.toString())}function G(t){return"number"==typeof t?Z(t):"string"==typeof t?C(t):t}var j=1e7,H=7,J=9007199254740992,K=i(J),R=Math.log(J);e.prototype.add=function(t){var r=G(t);if(this.sign!==r.sign)return this.subtract(r.negate());var n=this.value,i=r.value;return r.isSmall?new e(h(n,Math.abs(i)),this.sign):new e(l(n,i),this.sign)},e.prototype.plus=e.prototype.add,r.prototype.add=function(t){var o=G(t),a=this.value;if(0>a!==o.sign)return this.subtract(o.negate());var s=o.value;if(o.isSmall){if(n(a+s))return new r(a+s);s=i(Math.abs(s))}return new e(h(s,Math.abs(a)),0>a)},r.prototype.plus=r.prototype.add,e.prototype.subtract=function(t){var e=G(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?g(r,Math.abs(n),this.sign):v(r,n,this.sign)},e.prototype.minus=e.prototype.subtract,r.prototype.subtract=function(t){var e=G(t),n=this.value;if(0>n!==e.sign)return this.add(e.negate());var i=e.value;return e.isSmall?new r(n-i):g(i,Math.abs(n),n>=0)},r.prototype.minus=r.prototype.subtract,e.prototype.negate=function(){return new e(this.value,!this.sign)},r.prototype.negate=function(){var t=this.sign,e=new r(-this.value);return e.sign=!t,e},e.prototype.abs=function(){return new e(this.value,!1)},r.prototype.abs=function(){return new r(Math.abs(this.value))},e.prototype.multiply=function(t){var r,n=G(t),o=this.value,a=n.value,s=this.sign!==n.sign;if(n.isSmall){if(0===a)return _[0];if(1===a)return this;if(-1===a)return this.negate();if(r=Math.abs(a),j>r)return new e(d(o,r),s);a=i(r)}return o.length+a.length>4e3?new e(m(o,a),s):new e(c(o,a),s)},e.prototype.times=e.prototype.multiply,r.prototype._multiplyBySmall=function(t){return n(t.value*this.value)?new r(t.value*this.value):b(Math.abs(t.value),i(Math.abs(this.value)),this.sign!==t.sign)},e.prototype._multiplyBySmall=function(t){return 0===t.value?_[0]:1===t.value?this:-1===t.value?this.negate():b(Math.abs(t.value),this.value,this.sign!==t.sign)},r.prototype.multiply=function(t){return G(t)._multiplyBySmall(this)},r.prototype.times=r.prototype.multiply,e.prototype.square=function(){return new e(w(this.value),!1)},r.prototype.square=function(){var t=this.value*this.value;return n(t)?new r(t):new e(w(i(Math.abs(this.value))),!1)},e.prototype.divmod=function(t){var e=k(this,t);return{quotient:e[0],remainder:e[1]}},r.prototype.divmod=e.prototype.divmod,e.prototype.divide=function(t){return k(this,t)[0]},r.prototype.over=r.prototype.divide=e.prototype.over=e.prototype.divide,e.prototype.mod=function(t){return k(this,t)[1]},r.prototype.remainder=r.prototype.mod=e.prototype.remainder=e.prototype.mod,e.prototype.pow=function(t){var e,i,o,a=G(t),s=this.value,p=a.value;if(0===p)return _[1];if(0===s)return _[0];if(1===s)return _[1];if(-1===s)return a.isEven()?_[1]:_[-1];if(a.sign)return _[0];if(!a.isSmall)throw new Error("The exponent "+a.toString()+" is too large.");if(this.isSmall&&n(e=Math.pow(s,p)))return new r(u(e));for(i=this,o=_[1];p&!0&&(o=o.times(i),--p),0!==p;)p/=2,i=i.square();return o},r.prototype.pow=e.prototype.pow,e.prototype.modPow=function(t,e){if(t=G(t),e=G(e),e.isZero())throw new Error("Cannot take modPow with modulus 0");var r=_[1],n=this.mod(e);if(n.isZero())return _[0];for(;t.isPositive();)t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e);return r},r.prototype.modPow=e.prototype.modPow,e.prototype.compareAbs=function(t){var e=G(t),r=this.value,n=e.value;return e.isSmall?1:S(r,n)},r.prototype.compareAbs=function(t){var e=G(t),r=Math.abs(this.value),n=e.value;return e.isSmall?(n=Math.abs(n),r===n?0:r>n?1:-1):-1},e.prototype.compare=function(t){var e=G(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:S(r,n)*(this.sign?-1:1)},e.prototype.compareTo=e.prototype.compare,r.prototype.compare=function(t){var e=G(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:0>r!==e.sign?0>r?-1:1:0>r?1:-1},r.prototype.compareTo=r.prototype.compare,e.prototype.equals=function(t){return 0===this.compare(t)},r.prototype.eq=r.prototype.equals=e.prototype.eq=e.prototype.equals,e.prototype.notEquals=function(t){return 0!==this.compare(t)},r.prototype.neq=r.prototype.notEquals=e.prototype.neq=e.prototype.notEquals,e.prototype.greater=function(t){return this.compare(t)>0},r.prototype.gt=r.prototype.greater=e.prototype.gt=e.prototype.greater,e.prototype.lesser=function(t){return this.compare(t)<0},r.prototype.lt=r.prototype.lesser=e.prototype.lt=e.prototype.lesser,e.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},r.prototype.geq=r.prototype.greaterOrEquals=e.prototype.geq=e.prototype.greaterOrEquals,e.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},r.prototype.leq=r.prototype.lesserOrEquals=e.prototype.leq=e.prototype.lesserOrEquals,e.prototype.isEven=function(){return 0===(1&this.value[0])},r.prototype.isEven=function(){return 0===(1&this.value)},e.prototype.isOdd=function(){return 1===(1&this.value[0])},r.prototype.isOdd=function(){return 1===(1&this.value)},e.prototype.isPositive=function(){return!this.sign},r.prototype.isPositive=function(){return this.value>0},e.prototype.isNegative=function(){return this.sign},r.prototype.isNegative=function(){return this.value<0},e.prototype.isUnit=function(){return!1},r.prototype.isUnit=function(){return 1===Math.abs(this.value)},e.prototype.isZero=function(){return!1},r.prototype.isZero=function(){return 0===this.value},e.prototype.isDivisibleBy=function(t){var e=G(t),r=e.value;return 0===r?!1:1===r?!0:2===r?this.isEven():this.mod(e).equals(_[0])},r.prototype.isDivisibleBy=e.prototype.isDivisibleBy,e.prototype.isPrime=function(){var e=P(this);if(e!==t)return e;for(var r,n,i,o,a=this.abs(),s=a.prev(),u=[2,3,5,7,11,13,17,19],p=s;p.isEven();)p=p.divide(2);for(i=0;i<u.length;i++)if(o=bigInt(u[i]).modPow(p,a),!o.equals(_[1])&&!o.equals(s)){for(n=!0,r=p;n&&r.lesser(s);r=r.multiply(2))o=o.square().mod(a),o.equals(s)&&(n=!1);if(n)return!1}return!0},r.prototype.isPrime=e.prototype.isPrime,e.prototype.isProbablePrime=function(e){var r=P(this);if(r!==t)return r;for(var n=this.abs(),i=e===t?5:e,o=0;i>o;o++){var a=bigInt.randBetween(2,n.minus(2));if(!a.modPow(n.prev(),n).isUnit())return!1}return!0},r.prototype.isProbablePrime=e.prototype.isProbablePrime,e.prototype.next=function(){var t=this.value;return this.sign?g(t,1,this.sign):new e(h(t,1),this.sign)},r.prototype.next=function(){var t=this.value;return J>t+1?new r(t+1):new e(K,!1)},e.prototype.prev=function(){var t=this.value;return this.sign?new e(h(t,1),!0):g(t,1,this.sign)},r.prototype.prev=function(){var t=this.value;return t-1>-J?new r(t-1):new e(K,!0)};for(var z=[1];z[z.length-1]<=j;)z.push(2*z[z.length-1]);var F=z.length,U=z[F-1];e.prototype.shiftLeft=function(t){if(!O(t))return t.isNegative()?this.shiftRight(t.abs()):this.times(_[2].pow(t));if(t=+t,0>t)return this.shiftRight(-t);for(var e=this;t>=F;)e=e.multiply(U),t-=F-1;return e.multiply(z[t])},r.prototype.shiftLeft=e.prototype.shiftLeft,e.prototype.shiftRight=function(t){var e;if(!O(t))return t.isNegative()?this.shiftLeft(t.abs()):(e=this.divmod(_[2].pow(t)),e.remainder.isNegative()?e.quotient.prev():e.quotient);if(t=+t,0>t)return this.shiftLeft(-t);for(var r=this;t>=F;){if(r.isZero())return r;e=k(r,U),r=e[1].isNegative()?e[0].prev():e[0],t-=F-1}return e=k(r,z[t]),e[1].isNegative()?e[0].prev():e[0]},r.prototype.shiftRight=e.prototype.shiftRight,e.prototype.not=function(){return this.negate().prev()},r.prototype.not=e.prototype.not,e.prototype.and=function(t){return L(this,t,function(t,e){return t&e})},r.prototype.and=e.prototype.and,e.prototype.or=function(t){return L(this,t,function(t,e){return t|e})},r.prototype.or=e.prototype.or,e.prototype.xor=function(t){return L(this,t,function(t,e){return t^e})},r.prototype.xor=e.prototype.xor;var V=function(t,e){var n=_[0],i=_[1],o=t.length;if(e>=2&&36>=e&&o<=R/Math.log(e))return new r(parseInt(t,e));e=G(e);var a,s=[],u="-"===t[0];for(a=u?1:0;a<t.length;a++){var p=t[a].toLowerCase(),l=p.charCodeAt(0);if(l>=48&&57>=l)s.push(G(p));else if(l>=97&&122>=l)s.push(G(p.charCodeAt(0)-87));else{if("<"!==p)throw new Error(p+" is not a valid character");var h=a;do a++;while(">"!==t[a]);s.push(G(t.slice(h+1,a)))}}for(s.reverse(),a=0;a<s.length;a++)n=n.add(s[a].times(i)),i=i.times(e);return u?n.negate():n};e.prototype.toString=function(e){if(e===t&&(e=10),10!==e)return D(this,e);for(var r,n=this.value,i=n.length,o=String(n[--i]),a="0000000";--i>=0;)r=String(n[i]),o+=a.slice(r.length)+r;var s=this.sign?"-":"";return s+o},r.prototype.toString=function(e){return e===t&&(e=10),10!=e?D(this,e):String(this.value)},e.prototype.valueOf=function(){return+this.toString()},e.prototype.toJSNumber=e.prototype.valueOf,r.prototype.valueOf=function(){return this.value},r.prototype.toJSNumber=r.prototype.valueOf;for(var _=function(t,e){return"undefined"==typeof t?_[0]:"undefined"!=typeof e?10===+e?G(t):V(t,e):G(t)},Q=0;1e3>Q;Q++)_[Q]=new r(Q),Q>0&&(_[-Q]=new r(-Q));return _.one=_[1],_.zero=_[0],_.minusOne=_[-1],_.max=I,_.min=A,_.gcd=N,_.lcm=x,_.isInstance=function(t){return t instanceof e||t instanceof r},_.randBetween=B,_}();"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=bigInt),internal.nextPrime=function(t){for(var e=bigInt(t).plus(1);!e.isProbablePrime();)e=e.plus(1);return e},internal.mminverse=function(t,e){for(var r=bigInt(0),n=bigInt(1),i=bigInt(e),o=bigInt(t);!o.eq(0);){var a=i.divide(o),s=bigInt(r);r=bigInt(n),n=s.minus(a.times(n));var u=bigInt(i);i=bigInt(o),o=u.minus(a.times(o))}return i.gt(1)?!1:(r.lt(0)&&(r=r.plus(e)),r)},modern.rsaGenKeyPair=function(t,e,r){for(var n=internal.nextPrime(bigInt(t).pow(e)),i=internal.nextPrime(n.times(r)),o=n.times(i),a=n.minus(1).times(i.minus(1)),s=bigInt(65537);a.mod(s).eq(0);)s=internal.nextPrime(s);var u=internal.mminverse(s,a);return{p:n,q:i,n:o,phin:a,e:s,d:u}},modern.rsaCrypt=function(t,e,r){return bigInt(t).modPow(e,r)};for(var mainToolbarButtons=gid("main-ul").getElementsByTagName("a"),subMenus=gid("sub-nav").getElementsByTagName("ul"),i=0;i<mainToolbarButtons.length;i++)mainToolbarButtons[i].addEventListener("click",manageToolbarButtons);openPage();for(var subLinks=gid("sub-nav").getElementsByTagName("a"),i=0;i<subLinks.length;i++)subLinks[i].addEventListener("click",manageSubLinks);gid("caesar-en").addEventListener("click",function(){caesarDOMmanage(!0)}),gid("caesar-de").addEventListener("click",function(){caesarDOMmanage(!1)}),gid("vigenere-en").addEventListener("click",function(){vigenereDOMmanage(!0)}),gid("vigenere-de").addEventListener("click",function(){vigenereDOMmanage(!1)}),gid("rsa-key-gen-button").addEventListener("click",rsatogglemenu),gid("rsa-crypt-button").addEventListener("click",rsatogglemenu),gid("rsa-gen-keypair").addEventListener("click",function(){var t=modern.rsaGenKeyPair(gid("rsa-initbase").value,gid("rsa-initpow").value,gid("rsa-seconddiff").value),e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r].toString());var n={e:e.e,n:e.n},i={d:e.d,n:e.n};gid("rsa-key-gen-pub").innerHTML=JSON.stringify(n),gid("rsa-key-gen-priv").innerHTML=JSON.stringify(i)}),gid("rsa-encrypt").addEventListener("click",rsadomcrypt),gid("rsa-decrypt").addEventListener("click",rsadomcrypt);